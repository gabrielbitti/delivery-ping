{% extends "base.html" %}

{% block title %}{{ customer.complete_name }} - DeliveryPing{% endblock %}

{% block content %}
    <div class="page-header">
        <h1>Detalhes do Cliente</h1>
        <div>
            <a href="/web/customers" class="btn btn-secondary">← Voltar</a>
            <a href="/web/customers/{{ customer.id }}/edit" class="btn btn-warning">Editar</a>
        </div>
    </div>

    <div class="card">
        <div class="detail-grid">
            <div class="detail-item">
                <label>ID</label>
                <span>{{ customer.id }}</span>
            </div>

            <div class="detail-item">
                <label>Nome Completo</label>
                <span>{{ customer.complete_name }}</span>
            </div>

            <div class="detail-item">
                <label>Apelido</label>
                <span>{{ customer.nickname or '-' }}</span>
            </div>

            <div class="detail-item">
                <label>Telefone</label>
                <span>{{ customer.cellphone }}</span>
            </div>

            <div class="detail-item">
                <label>CPF</label>
                <span>{{ customer.cpf or '-' }}</span>
            </div>

            <div class="detail-item">
                <label>CNPJ</label>
                <span>{{ customer.cnpj or '-' }}</span>
            </div>

            <div class="detail-item">
                <label>Email</label>
                <span>{{ customer.email or '-' }}</span>
            </div>

            <div class="detail-item">
                <label>WhatsApp</label>
                <span>
                    {% if customer.has_whatsapp %}
                        <span class="badge badge-success">Sim</span>
                    {% else %}
                        <span class="badge badge-secondary">Não</span>
                    {% endif %}
                </span>
            </div>

            <div class="detail-item">
                <label>Status</label>
                <span>
                    {% if customer.is_active %}
                        <span class="badge badge-success">Ativo</span>
                    {% else %}
                        <span class="badge badge-danger">Inativo</span>
                    {% endif %}
                </span>
            </div>

            <div class="detail-item">
                <label>Criado em</label>
                <span>{{ customer.created_at.strftime('%d/%m/%Y %H:%M') if customer.created_at else '-' }}</span>
            </div>

            <div class="detail-item">
                <label>Atualizado em</label>
                <span>{{ customer.updated_at.strftime('%d/%m/%Y %H:%M') if customer.updated_at else '-' }}</span>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>Endereços</h2>
        <div id="addresses-list">
            <div class="addresses-grid">
                {% for address in customer.addresses %}
                    <div class="address-card">
                        <div class="address-header">
                            {% if address.is_primary %}
                                <span class="badge badge-primary">Principal</span>
                            {% else %}
                                <span>&nbsp</span>
                            {% endif %}
                        </div>
                        <p><strong>{{ address.complete_address }}</strong></p>
                        <p>{{ address.city }} - {{ address.state }}</p>
                        <p>CEP: {{ address.zip_code if address.zip_code else '-' }}</p>
                        <p>{{ address.country if address.country else '-' }}</p>
                        <div class="address-actions">
                            <button class="btn btn-sm btn-warning" onclick="editAddress('{{ address.id }}')">Editar</button>
                        </div>
                    </div>
                {% else %}
                    <p>Nenhum endereço cadastrado</p>
                {% endfor %}
            </div>
        </div>
        <button class="btn btn-primary" onclick="showAddressModal()">+ Adicionar Endereço</button>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        // const customerId = {{ customer.id }};

        function showAddressModal() {
            alert('Funcionalidade de adicionar endereço será implementada em breve!');
        }

        function editAddress(addressId) {
            alert(`Editar endereço ${addressId}`);
        }
    </script>
{% endblock %}
